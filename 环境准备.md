---
typora-root-url: /images
---

# Spring模块梳理

## spring基础架构图

![](/1.png)





![](/2.png)



## spring-core

* 包含框架基本的核心工具类，其他组件都要使用到这个包里的类
* 定义并提供资源的访问方式

IOC&DI提供最基础的服务



## spring-beans

spring主要面向bean编程（bop）

bean的定义、解析、创建

最重要的接口是 **BeanFactory**

## spring-context

核心: ApplicationContext

* 为spring提供了运行时环境，保存对象的状态
* 扩展了 BeanFactory

## spring-aop

最小化的动态代理实现

* jdk动态代理
* 基于类 cglib
* 只能使用运行时织入，仅支持方法级编织，仅支持方法执行切入点

根据模块里的gradle来查看依赖关系

## spring-aspectj+spring-instrument: full aspectj

* 编译器Weaving
* 类加载器Weaving
* 运行期Weaving

![](/3.png)



# Spring源码的下载和编译

安装jdk idea maven

java -version

mvn -v

idea 社区版就可以了





**注意：不同版本的spring编译方式是不一样的**



spring 5.2.0 一切以官方文档为准 去github下载源码

github branch tags 5.2.0.release

https://github.com/spring-projects/spring-framework/tree/v5.2.0.RELEASE

github 上面有源码编译方式介绍

https://github.com/spring-projects/spring-framework/wiki/Build-from-Source

导入idea

https://github.com/spring-projects/spring-framework/blob/master/import-into-idea.md

1. Precompile `spring-oxm` with `./gradlew :spring-oxm:compileTestJava`
2. Import into IntelliJ (File -> New -> Project from Existing Sources -> Navigate to directory -> Select build.gradle)
3. When prompted exclude the `spring-aspects` module (or after the import via File-> Project Structure -> Modules)
4. Code away
5. 



gradlew（wapper） 简化安装 部署 避免冲突

build.gradle 好比是maven的pom.xml



```
buildscript {
	repositories {
        maven{ url 'https://maven.aliyun.com/nexus/content/groups/public/' }
        maven{ url 'https://maven.aliyun.com/nexus/content/repositories/jcenter'}
    }
	dependencies {
		classpath 'org.asciidoctor:asciidoctorj-pdf:1.5.0-alpha.16'
		classpath 'io.spring.asciidoctor:spring-asciidoctor-extensions:0.1.3.RELEASE'
	}
}
```





allprojects 项目依赖

```
	repositories {
			maven{ url 'https://maven.aliyun.com/nexus/content/groups/public/'}
        	maven{ url 'https://maven.aliyun.com/nexus/content/repositories/jcenter'}
			mavenCentral()
			maven { url "https://repo.spring.io/libs-spring-framework-build" }
		}
```





然后./gradlew :spring-oxm:compileTestJava



报错、去掉 ./ 



![](/4.png)



idea open 源码 根目录，会自动调用gradle





spring-aspect 飘红，报错了

load/unload modules 排序spring-aspect

重新编译  idea上面的build project

